transports/smart_pkt.c